import{a as P}from"./chunk-HXCBLBTN.js";import{h as M,i as A,j as I}from"./chunk-JX4KCMVS.js";import{Ba as v,Fa as m,Ma as d,Oa as i,Pa as r,R as l,Ra as y,Sa as _,Ta as c,X as u,Xa as a,Y as g,Ya as f,ha as h,pb as b,qb as x,rb as C,sa as p,xb as F}from"./chunk-BN5C3YFC.js";function S(e,o){e&1&&(i(0,"div",3),a(1," Loading posts... "),r())}function w(e,o){if(e&1){let t=y();i(0,"div",6)(1,"div",7)(2,"h3"),a(3),r(),i(4,"button",8),_("click",function(){let s=u(t).$implicit,E=c(2);return g(E.onDelete(s.value.id))}),a(5,"Delete"),r()(),i(6,"p"),a(7),r()()}if(e&2){let t=o.$implicit;p(3),f(t.value.title),p(4),f(t.value.body)}}function D(e,o){if(e&1&&(i(0,"div",4),m(1,w,8,2,"div",5),r()),e&2){let t=c();p(),d("ngForOf",t.posts.controls)}}function G(e,o){e&1&&(i(0,"div",9),a(1," No posts found. "),r())}var O=class e{http=l(F);fb=l(A);auth=l(P);loading=h(!0);postFormArray=new M([]);constructor(){this.loadUserPosts()}loadUserPosts(){this.loading.set(!0);let o=this.auth.getUser();if(!o?.id){console.error("User not found"),this.loading.set(!1);return}this.http.get(`https://dummyjson.com/posts/user/${o.id}`).subscribe({next:t=>{let n=t.posts.map(s=>this.fb.group({id:[s.id],title:[s.title],body:[s.body]}));this.postFormArray.clear(),n.forEach(s=>this.postFormArray.push(s)),this.loading.set(!1)},error:()=>this.loading.set(!1)})}onDelete(o){this.loading.set(!0),this.http.delete(`https://dummyjson.com/posts/${o}`).subscribe({next:()=>{let t=this.postFormArray.controls.findIndex(n=>n.value.id===o);t!==-1&&this.postFormArray.removeAt(t),this.loading.set(!1)},error:()=>this.loading.set(!1)})}get posts(){return this.postFormArray}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=v({type:e,selectors:[["app-my-posts"]],decls:3,vars:3,consts:[["class","loading-spinner",4,"ngIf"],["class","posts",4,"ngIf"],["class","no-posts",4,"ngIf"],[1,"loading-spinner"],[1,"posts"],["class","post",4,"ngFor","ngForOf"],[1,"post"],[1,"post-header"],[3,"click"],[1,"no-posts"]],template:function(t,n){t&1&&m(0,S,2,0,"div",0)(1,D,2,1,"div",1)(2,G,2,0,"div",2),t&2&&(d("ngIf",n.loading()),p(),d("ngIf",!n.loading()&&n.posts.length>0),p(),d("ngIf",!n.loading()&&n.posts.length===0))},dependencies:[C,b,x,I],styles:[".post[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;padding:10px 0}.post[_ngcontent-%COMP%]:last-child{border-bottom:none}.post-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.post-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#f44336;color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer}"]})};export{O as MyPostsComponent};
